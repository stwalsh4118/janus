# [0-3] Create development and build scripts

[Back to task list](./tasks.md)

## Description

Create shell scripts to streamline development workflow, including setup automation, running backend/frontend in development mode with hot reload, and building production artifacts. These scripts simplify the developer experience and ensure consistent execution across environments.

## Status History

| Timestamp | Event Type | From Status | To Status | Details | User |
|-----------|------------|-------------|-----------|---------|------|
| 2025-10-11 00:00:00 | Created | N/A | Proposed | Task file created | Sean |

## Requirements

1. Create `scripts/setup.sh` for initial project setup
2. Create `scripts/dev-backend.sh` for running backend with hot reload
3. Create `scripts/dev-frontend.sh` for running frontend dev server
4. Create `scripts/build.sh` for building production artifacts
5. All scripts should have proper error handling
6. Scripts should check for prerequisites before execution
7. Scripts should provide clear output and feedback
8. Make all scripts executable

## Implementation Plan

### 1. Create Scripts Directory
```bash
mkdir -p scripts
```

### 2. Implement setup.sh

**Purpose**: One-time setup to initialize the development environment

**Features**:
- Check for required tools (Go, Node.js, pnpm, air)
- Install Go dependencies
- Install frontend dependencies
- Create .env from .env.example if it doesn't exist
- Create required directories (.cursor-voice)
- Verify installations
- Print success message with next steps

**Script outline**:
```bash
#!/bin/bash
set -e  # Exit on error

# Color output
GREEN='\033[0;32m'
RED='\033[0;31m'
NC='\033[0m' # No Color

echo "üöÄ Setting up Cursor Voice Chat development environment..."

# Check Go
# Check Node.js
# Check pnpm
# Check air
# Install backend dependencies
# Install frontend dependencies
# Create .env if needed
# Create .cursor-voice directory
# Print success message
```

### 3. Implement dev-backend.sh

**Purpose**: Start backend server with hot reload

**Features**:
- Load .env file
- Check if port 3000 is available
- Start air for hot reload
- Provide stop instructions

**Script outline**:
```bash
#!/bin/bash
set -e

echo "üîß Starting backend server with hot reload..."

# Load .env
# Check port availability
# Start air
```

### 4. Implement dev-frontend.sh

**Purpose**: Start frontend dev server

**Features**:
- Change to frontend directory
- Check if port 3001 is available
- Start pnpm dev
- Provide stop instructions

**Script outline**:
```bash
#!/bin/bash
set -e

echo "üé® Starting frontend dev server..."

# cd to frontend
# Check port availability
# Start pnpm dev
```

### 5. Implement build.sh

**Purpose**: Build production artifacts for both backend and frontend

**Features**:
- Clean previous builds
- Build Go binary
- Build Next.js static export
- Report build artifacts location
- Verify builds completed successfully

**Script outline**:
```bash
#!/bin/bash
set -e

echo "üèóÔ∏è  Building production artifacts..."

# Clean bin/ directory
# Build Go binary
# Build Next.js
# Report success and artifact locations
```

### 6. Make Scripts Executable
```bash
chmod +x scripts/*.sh
```

## Test Plan

### Manual Testing

Test each script individually to ensure proper functionality.

#### Test setup.sh
```bash
# Test on fresh clone (simulated)
./scripts/setup.sh

# Verify:
# - All dependencies installed
# - .env file created
# - .cursor-voice directory created
# - No errors in output
```

#### Test dev-backend.sh
```bash
./scripts/dev-backend.sh

# Verify:
# - Backend starts successfully
# - Air hot reload is active
# - Can access http://localhost:3000/api/health
# - Ctrl+C stops gracefully
```

#### Test dev-frontend.sh
```bash
./scripts/dev-frontend.sh

# Verify:
# - Frontend starts successfully
# - Can access http://localhost:3001
# - Hot reload works
# - Ctrl+C stops gracefully
```

#### Test build.sh
```bash
./scripts/build.sh

# Verify:
# - Go binary created in bin/janus
# - Next.js build completes
# - Artifacts are functional
# - No build errors
```

### Success Criteria
- [ ] All four scripts created in scripts/ directory
- [ ] All scripts are executable (chmod +x)
- [ ] setup.sh completes without errors on fresh setup
- [ ] setup.sh checks for all prerequisites
- [ ] dev-backend.sh starts backend with hot reload
- [ ] dev-frontend.sh starts frontend with hot reload
- [ ] build.sh produces working backend binary
- [ ] build.sh produces Next.js build artifacts
- [ ] All scripts have proper error handling
- [ ] All scripts provide clear output messages
- [ ] Scripts exit with appropriate error codes on failure

## Verification

Manual testing steps:
```bash
# 1. Test setup script
cd /home/sean/workspace/janus
./scripts/setup.sh
# Verify no errors and all dependencies installed

# 2. Test backend dev script
./scripts/dev-backend.sh
# Open http://localhost:3000/api/health in browser
# Modify a Go file, verify hot reload
# Press Ctrl+C to stop

# 3. Test frontend dev script (in new terminal)
./scripts/dev-frontend.sh
# Open http://localhost:3001 in browser
# Modify a React component, verify hot reload
# Press Ctrl+C to stop

# 4. Test build script
./scripts/build.sh
# Verify bin/janus exists and is executable
# Verify frontend/.next/standalone exists
# Run binary: ./bin/janus
# Verify it starts successfully

# 5. Test error handling
# Rename go.mod temporarily
./scripts/setup.sh
# Should fail with clear error message
# Restore go.mod
```

## Files Modified

### New Files
- `scripts/setup.sh`
- `scripts/dev-backend.sh`
- `scripts/dev-frontend.sh`
- `scripts/build.sh`

### Modified Files
- None (scripts are new)

